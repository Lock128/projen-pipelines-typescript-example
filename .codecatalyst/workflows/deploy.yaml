# ~~ Generated by projen. To modify, edit .projenrc.ts and run "npx projen".

Name: deploy
SchemaVersion: "1.0"
Triggers:
  - Type: PUSH
    Branches:
      - main
Actions:
  SynthCDKApplication:
    Identifier: aws/build@v1
    Inputs:
      Sources:
        - WorkflowSource
      Variables:
        - Name: CI
          Value: "true"
    Outputs:
      AutoDiscoverReports:
        Enabled: false
    Configuration:
      Steps:
        - Run: npx projen install:ci
        - Run: npx projen build
  PublishAssetsToAWS:
    Identifier: aws/build@v1
    Inputs:
      Sources:
        - WorkflowSource
      Variables:
        - Name: CI
          Value: "true"
    Outputs:
      AutoDiscoverReports:
        Enabled: false
    Configuration:
      Steps:
        - Run: npx projen publish:assets
    DependsOn:
      - SynthCDKApplication
  deploy_dev:
    Identifier: aws/build@v1
    Inputs:
      Sources:
        - WorkflowSource
      Variables:
        - Name: CI
          Value: "true"
    Outputs:
      AutoDiscoverReports:
        Enabled: false
    Configuration:
      Steps:
        - Run: npx projen install:ci
        - Run: npx projen deploy:dev
    DependsOn:
      - PublishAssetsToAWS
  deploy_dev2:
    Identifier: aws/build@v1
    Inputs:
      Sources:
        - WorkflowSource
      Variables:
        - Name: CI
          Value: "true"
    Outputs:
      AutoDiscoverReports:
        Enabled: false
    Configuration:
      Steps:
        - Run: npx projen install:ci
        - Run: npx projen deploy:dev2
    DependsOn:
      - PublishAssetsToAWS
      - deploy_dev
  deploy_staging:
    Identifier: aws/build@v1
    Inputs:
      Sources:
        - WorkflowSource
      Variables:
        - Name: CI
          Value: "true"
    Outputs:
      AutoDiscoverReports:
        Enabled: false
    Configuration:
      Steps:
        - Run: npx projen install:ci
        - Run: npx projen deploy:staging
    DependsOn:
      - PublishAssetsToAWS
      - deploy_dev2
  deploy_preprod:
    Identifier: aws/build@v1
    Inputs:
      Sources:
        - WorkflowSource
      Variables:
        - Name: CI
          Value: "true"
    Outputs:
      AutoDiscoverReports:
        Enabled: false
    Configuration:
      Steps:
        - Run: npx projen install:ci
        - Run: npx projen deploy:preprod
    DependsOn:
      - PublishAssetsToAWS
      - deploy_staging
  approve_prod:
    Identifier: aws/approval@v1
    DependsOn:
      - deploy_preprod
    Configuration:
      ApprovalsRequired: 1
  deploy_prod:
    Identifier: aws/build@v1
    Inputs:
      Sources:
        - WorkflowSource
      Variables:
        - Name: CI
          Value: "true"
    Outputs:
      AutoDiscoverReports:
        Enabled: false
    Configuration:
      Steps:
        - Run: npx projen install:ci
        - Run: npx projen deploy:prod
    DependsOn:
      - PublishAssetsToAWS
      - approve_prod
  approve_prod_us:
    Identifier: aws/approval@v1
    DependsOn:
      - deploy_prod
    Configuration:
      ApprovalsRequired: 1
  deploy_prod_us:
    Identifier: aws/build@v1
    Inputs:
      Sources:
        - WorkflowSource
      Variables:
        - Name: CI
          Value: "true"
    Outputs:
      AutoDiscoverReports:
        Enabled: false
    Configuration:
      Steps:
        - Run: npx projen install:ci
        - Run: npx projen deploy:prod_us
    DependsOn:
      - PublishAssetsToAWS
      - approve_prod_us
  deploy_prod_in:
    Identifier: aws/build@v1
    Inputs:
      Sources:
        - WorkflowSource
      Variables:
        - Name: CI
          Value: "true"
    Outputs:
      AutoDiscoverReports:
        Enabled: false
    Configuration:
      Steps:
        - Run: npx projen install:ci
        - Run: npx projen deploy:prod_in
    DependsOn:
      - PublishAssetsToAWS
      - deploy_prod_us
  indeploy_ind1:
    Identifier: aws/build@v1
    Inputs:
      Sources:
        - WorkflowSource
      Variables:
        - Name: CI
          Value: "true"
    Outputs:
      AutoDiscoverReports:
        Enabled: false
    Configuration:
      Steps:
        - Run: npx projen install:ci
        - Run: npx projen deploy:ind1
    DependsOn:
      - PublishAssetsToAWS
  indeploy_ind2:
    Identifier: aws/build@v1
    Inputs:
      Sources:
        - WorkflowSource
      Variables:
        - Name: CI
          Value: "true"
    Outputs:
      AutoDiscoverReports:
        Enabled: false
    Configuration:
      Steps:
        - Run: npx projen install:ci
        - Run: npx projen deploy:ind2
    DependsOn:
      - PublishAssetsToAWS
